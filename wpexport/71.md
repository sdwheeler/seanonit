Now that you have
[ARAPI.NET installed](http://seanonit.wordpress.com/2014/10/22/installing-bmcs-arapi-net-library/)
let's take a look at an example using C#. There are a couple of tricks required to get your C#
project to compile and run properly.

- Be sure the ARAPI.NET library is installed correctly and that the directory path has been added to
  your System PATH environment variable.
- Set the "Target Platform" to x86 in the Build properties of your Visual Studio project.
- Add references for both BMC.ARSystem.dll and BMC.arnettoc.dll to your project.
  ![Project Reference](https://seanonit.files.wordpress.com/2014/11/cprojref.png)
- Include the "using BMC.ARSystem;" statement in your code.

In this example I am creating a simple query to find all the users in Remedy that are configured as
"Support Staff" and output that list in a CSV format. I have used this to do a periodic audit of our
users and remove users that have changed job roles and no longer need "Support Staff" access.

```csharp
using System;
using System.Collections.Generic;
using BMC.ARSystem;

namespace SupportStaff
{
  class Program
  {
    static void Main(string[] args)
    {
      string arServerName = "arserver.contoso.com";
      string arUsername = "Demo";
      string arUserPassword = "Password";
      string arAuthentication = "";
      Int32 arServerPort = 51100;

      // Log into the AR Server
      Server arServer = new Server();
      arServer.Login(arServerName, arUsername, arUserPassword, arAuthentication, arServerPort);

      // Create list of fields we want to return from the Form
      EntryListFieldList peopleEntryFieldList = new EntryListFieldList();
      peopleEntryFieldList.AddField(1, 50, ""); // Person ID
      peopleEntryFieldList.AddField(4, 50, ""); // Remedy ID
      peopleEntryFieldList.AddField(1000000025, 50, ""); // Support Staff
      peopleEntryFieldList.AddField(1000006694, 50, ""); // Auth Alias
      peopleEntryFieldList.AddField(1764007102, 50, ""); // Network ID

      // Create the Qualifier string used to query the Form
      string qualifier = @"'1000000025' = 0"; // Support Staff value 0 = 'Yes'

      // Execute the query
      EntryFieldValueList entryListWithFields = arServer.GetListEntryWithFields("CTM:People", qualifier, peopleEntryFieldList, 0, 0);

      //Process the results
      if (entryListWithFields.Count != 0)
      {
        Console.WriteLine("\"PPL\",\"RemedyID\",\"AuthAlias\",\"NetworkID\"");
        foreach (var entry in entryListWithFields)
        {
          Console.WriteLine("\"{0}\",\"{1}\",\"{2}\",\"{3}\"",
          entry.FieldValues[1],
          entry.FieldValues[4],
          entry.FieldValues[1000006694],
          entry.FieldValues[1764007102]);
        }
      }
      arServer.Logout();
    }
  }
}
```
